{
  "info": {
    "name": "AI PPT Assistant API",
    "description": "AI驱动的PowerPoint演示文稿生成和管理API的完整Postman集合",
    "version": "1.0.0",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "apikey",
    "apikey": [
      {
        "key": "key",
        "value": "X-API-Key",
        "type": "string"
      },
      {
        "key": "value",
        "value": "{{api_key}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "base_url",
      "value": "https://your-api-gateway-url.execute-api.us-east-1.amazonaws.com/v1",
      "type": "string",
      "description": "API基础URL"
    },
    {
      "key": "api_key",
      "value": "YOUR_API_KEY_HERE",
      "type": "string",
      "description": "您的API密钥"
    },
    {
      "key": "presentation_id",
      "value": "",
      "type": "string",
      "description": "演示文稿ID（从创建响应中获取）"
    },
    {
      "key": "session_id",
      "value": "",
      "type": "string",
      "description": "会话ID（从创建响应中获取）"
    },
    {
      "key": "task_id",
      "value": "",
      "type": "string",
      "description": "任务ID（从任务创建响应中获取）"
    },
    {
      "key": "slide_id",
      "value": "slide-001",
      "type": "string",
      "description": "幻灯片ID"
    }
  ],
  "item": [
    {
      "name": "演示文稿管理",
      "description": "演示文稿的创建、查询和管理相关接口",
      "item": [
        {
          "name": "创建新演示文稿",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"人工智能在医疗领域的应用\",\n  \"topic\": \"介绍AI在医疗诊断、药物研发、个性化治疗等方面的应用，包括具体案例和未来发展趋势\",\n  \"audience\": \"technical\",\n  \"duration\": 30,\n  \"slide_count\": 20,\n  \"language\": \"zh\",\n  \"style\": \"professional\",\n  \"template\": \"technology_showcase\",\n  \"include_speaker_notes\": true,\n  \"include_images\": true,\n  \"metadata\": {\n    \"department\": \"Research\",\n    \"project\": \"AI-Healthcare-2024\"\n  },\n  \"preferences\": {\n    \"font_size\": \"large\",\n    \"color_scheme\": \"blue\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/presentations",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "presentations"
              ]
            },
            "description": "创建一个新的AI生成演示文稿任务。系统将基于提供的标题、主题和配置参数异步生成演示文稿内容。"
          },
          "response": [
            {
              "name": "成功创建",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"title\": \"人工智能在医疗领域的应用\",\n  \"topic\": \"介绍AI在医疗诊断、药物研发、个性化治疗等方面的应用\",\n  \"audience\": \"technical\",\n  \"duration\": 30\n}"
                },
                "url": {
                  "raw": "{{base_url}}/presentations",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "presentations"
                  ]
                }
              },
              "status": "Accepted",
              "code": 202,
              "body": "{\n  \"presentation_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"title\": \"人工智能在医疗领域的应用\",\n  \"status\": \"pending\",\n  \"progress\": 0,\n  \"created_at\": \"2024-09-07T10:30:00Z\",\n  \"updated_at\": \"2024-09-07T10:30:00Z\",\n  \"estimated_completion_time\": \"2024-09-07T10:45:00Z\"\n}"
            }
          ]
        },
        {
          "name": "获取演示文稿列表",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/presentations?limit=20&offset=0&status=completed&sort_by=created_at&sort_order=desc",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "presentations"
              ],
              "query": [
                {
                  "key": "limit",
                  "value": "20",
                  "description": "返回结果数量限制"
                },
                {
                  "key": "offset",
                  "value": "0",
                  "description": "结果偏移量"
                },
                {
                  "key": "status",
                  "value": "completed",
                  "description": "状态过滤"
                },
                {
                  "key": "sort_by",
                  "value": "created_at",
                  "description": "排序字段"
                },
                {
                  "key": "sort_order",
                  "value": "desc",
                  "description": "排序顺序"
                }
              ]
            },
            "description": "获取演示文稿列表，支持分页和状态过滤"
          },
          "response": []
        },
        {
          "name": "获取演示文稿状态",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/presentations/{{presentation_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "presentations",
                "{{presentation_id}}"
              ]
            },
            "description": "获取指定演示文稿的详细状态信息"
          },
          "response": []
        },
        {
          "name": "下载演示文稿",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/presentations/{{presentation_id}}/download",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "presentations",
                "{{presentation_id}}",
                "download"
              ]
            },
            "description": "下载完成的演示文稿文件（PPTX格式）"
          },
          "response": []
        },
        {
          "name": "修改幻灯片",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"modification_type\": \"content\",\n  \"content\": {\n    \"title\": \"AI诊断系统的核心优势\",\n    \"body\": \"基于深度学习的AI诊断系统具有高准确性、快速响应和持续学习能力\",\n    \"bullet_points\": [\n      \"99.5% 的诊断准确率\",\n      \"3秒内完成初步诊断\",\n      \"支持24/7不间断服务\"\n    ]\n  },\n  \"instructions\": \"请突出强调准确率数据，添加相关的图表说明\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/presentations/{{presentation_id}}/slides/{{slide_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "presentations",
                "{{presentation_id}}",
                "slides",
                "{{slide_id}}"
              ]
            },
            "description": "修改指定幻灯片的内容、样式或布局。支持多种修改类型：content、style、layout、image、speaker_notes"
          },
          "response": []
        }
      ]
    },
    {
      "name": "会话管理",
      "description": "用户会话的创建和管理",
      "item": [
        {
          "name": "创建会话",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"user_id\": \"user123\",\n  \"session_name\": \"医疗AI演示准备\",\n  \"metadata\": {\n    \"project\": \"healthcare-ai\",\n    \"deadline\": \"2024-12-31\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/sessions",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "sessions"
              ]
            },
            "description": "创建新的用户会话，用于跟踪用户的交互历史"
          },
          "response": []
        },
        {
          "name": "获取会话信息",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/sessions/{{session_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "sessions",
                "{{session_id}}"
              ]
            },
            "description": "获取指定会话的详细信息"
          },
          "response": []
        }
      ]
    },
    {
      "name": "AI代理",
      "description": "AI代理的执行和管理",
      "item": [
        {
          "name": "执行协调代理",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"input\": \"生成一个关于机器学习基础的10页演示文稿\",\n  \"session_id\": \"{{session_id}}\",\n  \"enable_trace\": false,\n  \"parameters\": {\n    \"temperature\": 0.7,\n    \"max_tokens\": 1000\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/agents/orchestrator/execute",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "agents",
                "orchestrator",
                "execute"
              ]
            },
            "description": "执行主协调代理来处理用户请求"
          },
          "response": []
        },
        {
          "name": "执行内容生成代理",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"input\": \"为医疗AI主题生成详细的演示内容\",\n  \"session_id\": \"{{session_id}}\",\n  \"parameters\": {\n    \"content_type\": \"presentation\",\n    \"style\": \"professional\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/agents/content/execute",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "agents",
                "content",
                "execute"
              ]
            },
            "description": "执行内容生成代理"
          },
          "response": []
        },
        {
          "name": "执行视觉设计代理",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"input\": \"为技术演示设计视觉元素和布局\",\n  \"session_id\": \"{{session_id}}\",\n  \"parameters\": {\n    \"design_style\": \"modern\",\n    \"color_scheme\": \"blue\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/agents/visual/execute",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "agents",
                "visual",
                "execute"
              ]
            },
            "description": "执行视觉设计代理"
          },
          "response": []
        },
        {
          "name": "执行编译代理",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"input\": \"编译演示文稿并生成PPTX文件\",\n  \"session_id\": \"{{session_id}}\",\n  \"parameters\": {\n    \"output_format\": \"pptx\",\n    \"include_notes\": true\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/agents/compiler/execute",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "agents",
                "compiler",
                "execute"
              ]
            },
            "description": "执行演示文稿编译代理"
          },
          "response": []
        }
      ]
    },
    {
      "name": "任务管理",
      "description": "异步任务的状态跟踪",
      "item": [
        {
          "name": "获取任务状态",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/tasks/{{task_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "tasks",
                "{{task_id}}"
              ]
            },
            "description": "获取指定任务的执行状态和结果"
          },
          "response": []
        }
      ]
    },
    {
      "name": "模板管理",
      "description": "演示文稿模板的查询和管理",
      "item": [
        {
          "name": "获取模板列表",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/templates?category=技术&limit=10",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "templates"
              ],
              "query": [
                {
                  "key": "category",
                  "value": "技术",
                  "description": "模板分类过滤"
                },
                {
                  "key": "limit",
                  "value": "10",
                  "description": "返回结果数量限制"
                }
              ]
            },
            "description": "获取可用的演示文稿模板列表"
          },
          "response": []
        }
      ]
    },
    {
      "name": "系统监控",
      "description": "系统健康检查和监控",
      "item": [
        {
          "name": "健康检查",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/health",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "health"
              ]
            },
            "description": "检查API服务的健康状态（不需要API密钥）"
          },
          "response": []
        },
        {
          "name": "就绪检查",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/health/ready",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "health",
                "ready"
              ]
            },
            "description": "检查API服务是否准备好接受请求（不需要API密钥）"
          },
          "response": []
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// 设置请求ID",
          "pm.globals.set('request_id', pm.globals.replaceIn('{{$randomUUID}}'));"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// 通用测试脚本",
          "pm.test('Status code is success', function () {",
          "    pm.expect(pm.response.code).to.be.oneOf([200, 201, 202]);",
          "});",
          "",
          "pm.test('Response time is less than 10 seconds', function () {",
          "    pm.expect(pm.response.responseTime).to.be.below(10000);",
          "});",
          "",
          "// 自动设置变量",
          "if (pm.response.code >= 200 && pm.response.code < 300) {",
          "    const responseJson = pm.response.json();",
          "    ",
          "    // 设置presentation_id",
          "    if (responseJson.presentation_id) {",
          "        pm.collectionVariables.set('presentation_id', responseJson.presentation_id);",
          "        console.log('Set presentation_id:', responseJson.presentation_id);",
          "    }",
          "    ",
          "    // 设置session_id",
          "    if (responseJson.session_id) {",
          "        pm.collectionVariables.set('session_id', responseJson.session_id);",
          "        console.log('Set session_id:', responseJson.session_id);",
          "    }",
          "    ",
          "    // 设置task_id",
          "    if (responseJson.task_id) {",
          "        pm.collectionVariables.set('task_id', responseJson.task_id);",
          "        console.log('Set task_id:', responseJson.task_id);",
          "    }",
          "}"
        ]
      }
    }
  ]
}