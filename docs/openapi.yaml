openapi: 3.0.3
info:
  title: AI PPT Assistant API
  version: 1.0.0
  description: |
    AI驱动的PowerPoint演示文稿生成和管理API。
    
    ## 功能特性
    - 基于主题和要求自动生成演示文稿
    - 演示文稿状态跟踪和管理
    - 幻灯片内容修改和定制
    - 模板管理和选择
    - 任务状态监控
    
    ## 认证方式
    使用API密钥进行身份验证。在请求头中包含 `X-API-Key`。
    
    ## 错误处理
    API使用标准HTTP状态码，错误响应包含详细的错误信息。
  contact:
    name: AI PPT Assistant Support
    email: support@ai-ppt-assistant.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: https://ai-ppt-assistant.com/terms

servers:
  - url: https://api.ai-ppt-assistant.com/v1
    description: 生产环境
  - url: https://staging-api.ai-ppt-assistant.com/v1
    description: 测试环境
  - url: http://localhost:3000/v1
    description: 本地开发环境

security:
  - ApiKeyAuth: []

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key

  schemas:
    # 请求模型
    GeneratePresentationRequest:
      type: object
      required:
        - title
        - topic
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 200
          description: 演示文稿标题
          example: "人工智能在医疗领域的应用"
        topic:
          type: string
          minLength: 1
          maxLength: 1000
          description: 演示文稿主题和详细要求
          example: "介绍AI在医疗诊断、药物研发、个性化治疗等方面的应用，包括具体案例和未来发展趋势"
        audience:
          type: string
          default: general
          enum: [general, technical, executive, academic, student]
          description: 目标受众类型
          example: "technical"
        duration:
          type: integer
          minimum: 5
          maximum: 120
          default: 20
          description: 演示时长（分钟）
          example: 30
        slide_count:
          type: integer
          minimum: 5
          maximum: 100
          default: 15
          description: 期望的幻灯片数量
          example: 20
        language:
          type: string
          default: en
          enum: [en, ja, zh, es, fr, de, pt, ko]
          description: 演示文稿语言
          example: "zh"
        style:
          type: string
          default: professional
          enum: [professional, creative, minimalist, technical, academic]
          description: 演示文稿风格
          example: "professional"
        template:
          type: string
          default: default
          enum: [default, executive_summary, technology_showcase, sales_pitch, educational]
          description: 演示文稿模板
          example: "technology_showcase"
        include_speaker_notes:
          type: boolean
          default: true
          description: 是否包含演讲备注
          example: true
        include_images:
          type: boolean
          default: true
          description: 是否包含图片
          example: true
        session_id:
          type: string
          format: uuid
          description: 会话ID（可选）
          example: "550e8400-e29b-41d4-a716-446655440000"
        metadata:
          type: object
          additionalProperties: true
          description: 额外的元数据
          example:
            department: "Research"
            project: "AI-Healthcare-2024"
        preferences:
          type: object
          additionalProperties: true
          description: 用户偏好设置
          example:
            font_size: "large"
            color_scheme: "blue"

    ModifySlideRequest:
      type: object
      required:
        - modification_type
      properties:
        modification_type:
          type: string
          enum: [content, style, layout, image, speaker_notes]
          description: 修改类型
          example: "content"
        content:
          type: object
          properties:
            title:
              type: string
              maxLength: 200
              description: 幻灯片标题
              example: "AI诊断系统的优势"
            body:
              type: string
              maxLength: 2000
              description: 幻灯片主体内容
              example: "AI诊断系统能够提供24/7不间断服务，提高诊断准确性和效率"
            bullet_points:
              type: array
              items:
                type: string
                maxLength: 500
              maxItems: 10
              description: 要点列表
              example: ["提高诊断准确性", "减少人为错误", "加快诊断速度"]
        style:
          type: object
          properties:
            theme:
              type: string
              enum: [professional, creative, minimalist, technical, academic]
              description: 主题风格
              example: "professional"
            color_scheme:
              type: string
              enum: [default, blue, green, red, purple, orange]
              description: 配色方案
              example: "blue"
            font_family:
              type: string
              enum: [default, arial, calibri, times, helvetica]
              description: 字体系列
              example: "calibri"
        layout:
          type: object
          properties:
            template:
              type: string
              enum: [title_slide, content_slide, two_column, image_slide, conclusion]
              description: 布局模板
              example: "two_column"
            alignment:
              type: string
              enum: [left, center, right, justify]
              description: 文本对齐方式
              example: "left"
        image:
          type: object
          properties:
            action:
              type: string
              enum: [add, replace, remove, resize, reposition]
              description: 图片操作类型
              example: "add"
            search_query:
              type: string
              maxLength: 200
              description: 图片搜索关键词
              example: "医疗AI诊断系统"
            position:
              type: string
              enum: [top, bottom, left, right, center]
              description: 图片位置
              example: "right"
            size:
              type: string
              enum: [small, medium, large, full]
              description: 图片大小
              example: "medium"
        speaker_notes:
          type: string
          maxLength: 3000
          description: 演讲备注
          example: "重点强调AI系统的准确性和可靠性，提及具体的统计数据"
        instructions:
          type: string
          maxLength: 1000
          description: 修改说明
          example: "请突出强调AI技术的核心优势，添加相关的统计图表"

    CreateSessionRequest:
      type: object
      required:
        - user_id
      properties:
        user_id:
          type: string
          minLength: 1
          maxLength: 50
          pattern: "^[a-zA-Z0-9_-]+$"
          description: 用户ID
          example: "user123"
        session_name:
          type: string
          minLength: 1
          maxLength: 100
          description: 会话名称
          example: "医疗AI演示准备"
        metadata:
          type: object
          additionalProperties: true
          description: 会话元数据
          example:
            project: "healthcare-ai"
            deadline: "2024-12-31"

    ExecuteAgentRequest:
      type: object
      required:
        - input
      properties:
        input:
          type: string
          minLength: 1
          maxLength: 2000
          description: 代理输入文本
          example: "生成一个关于机器学习基础的10页演示文稿"
        session_id:
          type: string
          format: uuid
          description: 会话ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        enable_trace:
          type: boolean
          default: false
          description: 是否启用跟踪
          example: false
        parameters:
          type: object
          additionalProperties: true
          description: 代理参数
          example:
            temperature: 0.7
            max_tokens: 1000

    # 响应模型
    PresentationResponse:
      type: object
      properties:
        presentation_id:
          type: string
          format: uuid
          description: 演示文稿ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        title:
          type: string
          description: 演示文稿标题
          example: "人工智能在医疗领域的应用"
        status:
          type: string
          enum: [pending, processing, completed, failed, cancelled]
          description: 处理状态
          example: "processing"
        progress:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: 完成进度（0-1）
          example: 0.6
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: "2024-09-07T10:30:00Z"
        updated_at:
          type: string
          format: date-time
          description: 更新时间
          example: "2024-09-07T10:35:00Z"
        estimated_completion_time:
          type: string
          format: date-time
          description: 预计完成时间
          example: "2024-09-07T10:45:00Z"
        slide_count:
          type: integer
          description: 实际幻灯片数量
          example: 18
        download_url:
          type: string
          format: uri
          description: 下载链接（状态为completed时可用）
          example: "https://api.ai-ppt-assistant.com/v1/presentations/550e8400-e29b-41d4-a716-446655440000/download"
        preview_url:
          type: string
          format: uri
          description: 预览链接
          example: "https://api.ai-ppt-assistant.com/v1/presentations/550e8400-e29b-41d4-a716-446655440000/preview"
        session_id:
          type: string
          format: uuid
          description: 关联的会话ID
          example: "550e8400-e29b-41d4-a716-446655440000"

    TaskResponse:
      type: object
      properties:
        task_id:
          type: string
          format: uuid
          description: 任务ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        type:
          type: string
          description: 任务类型
          example: "generate_presentation"
        status:
          type: string
          enum: [pending, processing, completed, failed, cancelled]
          description: 任务状态
          example: "processing"
        progress:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: 完成进度
          example: 0.75
        result:
          type: object
          description: 任务结果（完成时可用）
          example:
            presentation_id: "550e8400-e29b-41d4-a716-446655440000"
            download_url: "https://api.ai-ppt-assistant.com/v1/presentations/550e8400-e29b-41d4-a716-446655440000/download"
        error:
          type: object
          properties:
            code:
              type: string
              description: 错误代码
            message:
              type: string
              description: 错误消息
          description: 错误信息（失败时可用）
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: "2024-09-07T10:30:00Z"
        updated_at:
          type: string
          format: date-time
          description: 更新时间
          example: "2024-09-07T10:40:00Z"

    Template:
      type: object
      properties:
        template_id:
          type: string
          description: 模板ID
          example: "executive_summary"
        name:
          type: string
          description: 模板名称
          example: "执行摘要"
        description:
          type: string
          description: 模板描述
          example: "适用于高管汇报的专业模板"
        category:
          type: string
          description: 模板分类
          example: "商务"
        style:
          type: string
          description: 模板风格
          example: "corporate"
        default_slide_count:
          type: integer
          description: 默认幻灯片数量
          example: 15
        preview_url:
          type: string
          format: uri
          description: 预览图片URL
          example: "https://api.ai-ppt-assistant.com/v1/templates/executive_summary/preview"

    SessionResponse:
      type: object
      properties:
        session_id:
          type: string
          format: uuid
          description: 会话ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        user_id:
          type: string
          description: 用户ID
          example: "user123"
        session_name:
          type: string
          description: 会话名称
          example: "医疗AI演示准备"
        status:
          type: string
          enum: [active, inactive, expired]
          description: 会话状态
          example: "active"
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: "2024-09-07T10:00:00Z"
        last_activity:
          type: string
          format: date-time
          description: 最后活动时间
          example: "2024-09-07T10:30:00Z"
        expires_at:
          type: string
          format: date-time
          description: 过期时间
          example: "2024-09-07T18:00:00Z"
        metadata:
          type: object
          additionalProperties: true
          description: 会话元数据

    HealthResponse:
      type: object
      properties:
        status:
          type: string
          enum: [healthy, unhealthy]
          description: 健康状态
          example: "healthy"
        timestamp:
          type: string
          format: date-time
          description: 检查时间
          example: "2024-09-07T10:30:00Z"
        version:
          type: string
          description: 系统版本
          example: "1.0.0"
        dependencies:
          type: object
          properties:
            database:
              type: string
              enum: [healthy, unhealthy]
              example: "healthy"
            s3:
              type: string
              enum: [healthy, unhealthy]
              example: "healthy"
            lambda:
              type: string
              enum: [healthy, unhealthy]
              example: "healthy"

    ErrorResponse:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
          description: 错误代码
          example: "VALIDATION_ERROR"
        message:
          type: string
          description: 错误消息
          example: "请求参数验证失败"
        details:
          type: array
          items:
            type: object
            properties:
              field:
                type: string
                description: 错误字段
                example: "title"
              code:
                type: string
                description: 字段错误代码
                example: "REQUIRED"
              message:
                type: string
                description: 字段错误消息
                example: "标题字段是必需的"
          description: 详细错误信息
        request_id:
          type: string
          description: 请求ID
          example: "req-123456789"
        timestamp:
          type: string
          format: date-time
          description: 错误发生时间
          example: "2024-09-07T10:30:00Z"

    PaginatedResponse:
      type: object
      properties:
        items:
          type: array
          description: 数据项列表
        total:
          type: integer
          description: 总数量
          example: 100
        limit:
          type: integer
          description: 每页限制
          example: 20
        offset:
          type: integer
          description: 偏移量
          example: 0
        has_more:
          type: boolean
          description: 是否有更多数据
          example: true
        next_offset:
          type: integer
          description: 下一页偏移量
          example: 20

  responses:
    BadRequest:
      description: 请求参数错误
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "VALIDATION_ERROR"
            message: "请求参数验证失败"
            details:
              - field: "title"
                code: "REQUIRED"
                message: "标题字段是必需的"
            request_id: "req-123456789"
            timestamp: "2024-09-07T10:30:00Z"

    Unauthorized:
      description: 认证失败
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "UNAUTHORIZED"
            message: "API密钥无效或已过期"
            request_id: "req-123456789"
            timestamp: "2024-09-07T10:30:00Z"

    Forbidden:
      description: 权限不足
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "FORBIDDEN"
            message: "没有访问此资源的权限"
            request_id: "req-123456789"
            timestamp: "2024-09-07T10:30:00Z"

    NotFound:
      description: 资源未找到
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "NOT_FOUND"
            message: "请求的资源未找到"
            request_id: "req-123456789"
            timestamp: "2024-09-07T10:30:00Z"

    TooManyRequests:
      description: 请求频率超限
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "RATE_LIMIT_EXCEEDED"
            message: "请求频率超过限制，请稍后重试"
            request_id: "req-123456789"
            timestamp: "2024-09-07T10:30:00Z"
      headers:
        Retry-After:
          description: 重试等待时间（秒）
          schema:
            type: integer
            example: 60

    InternalServerError:
      description: 服务器内部错误
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error: "INTERNAL_ERROR"
            message: "服务器内部错误，请稍后重试"
            request_id: "req-123456789"
            timestamp: "2024-09-07T10:30:00Z"

  parameters:
    PresentationId:
      name: id
      in: path
      required: true
      description: 演示文稿ID
      schema:
        type: string
        format: uuid
      example: "550e8400-e29b-41d4-a716-446655440000"

    SlideId:
      name: slideId
      in: path
      required: true
      description: 幻灯片ID
      schema:
        type: string
      example: "slide-001"

    TaskId:
      name: task_id
      in: path
      required: true
      description: 任务ID
      schema:
        type: string
        format: uuid
      example: "550e8400-e29b-41d4-a716-446655440000"

    SessionId:
      name: id
      in: path
      required: true
      description: 会话ID
      schema:
        type: string
        format: uuid
      example: "550e8400-e29b-41d4-a716-446655440000"

    AgentName:
      name: name
      in: path
      required: true
      description: 代理名称
      schema:
        type: string
        enum: [orchestrator, content, visual, compiler]
      example: "orchestrator"

    Limit:
      name: limit
      in: query
      description: 返回结果数量限制
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 20
      example: 20

    Offset:
      name: offset
      in: query
      description: 结果偏移量
      schema:
        type: integer
        minimum: 0
        default: 0
      example: 0

    Status:
      name: status
      in: query
      description: 状态过滤
      schema:
        type: string
        enum: [pending, processing, completed, failed, cancelled]
      example: "completed"

paths:
  /presentations:
    post:
      tags:
        - Presentations
      summary: 生成新演示文稿
      description: |
        创建一个新的AI生成演示文稿任务。系统将基于提供的标题、主题和配置参数
        异步生成演示文稿内容。
      operationId: createPresentation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GeneratePresentationRequest'
            example:
              title: "人工智能在医疗领域的应用"
              topic: "介绍AI在医疗诊断、药物研发、个性化治疗等方面的应用"
              audience: "technical"
              duration: 30
              slide_count: 20
              language: "zh"
              style: "professional"
              template: "technology_showcase"
              include_speaker_notes: true
              include_images: true
      responses:
        '202':
          description: 演示文稿生成任务已创建
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PresentationResponse'
              example:
                presentation_id: "550e8400-e29b-41d4-a716-446655440000"
                title: "人工智能在医疗领域的应用"
                status: "pending"
                progress: 0
                created_at: "2024-09-07T10:30:00Z"
                updated_at: "2024-09-07T10:30:00Z"
                estimated_completion_time: "2024-09-07T10:45:00Z"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/TooManyRequests'
        '500':
          $ref: '#/components/responses/InternalServerError'

    get:
      tags:
        - Presentations
      summary: 列出演示文稿
      description: 获取演示文稿列表，支持分页和状态过滤
      operationId: listPresentations
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/Status'
        - name: sort_by
          in: query
          description: 排序字段
          schema:
            type: string
            enum: [created_at, updated_at, title, status]
            default: created_at
        - name: sort_order
          in: query
          description: 排序顺序
          schema:
            type: string
            enum: [asc, desc]
            default: desc
      responses:
        '200':
          description: 演示文稿列表
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/PaginatedResponse'
                  - type: object
                    properties:
                      items:
                        type: array
                        items:
                          $ref: '#/components/schemas/PresentationResponse'
              example:
                items:
                  - presentation_id: "550e8400-e29b-41d4-a716-446655440000"
                    title: "人工智能在医疗领域的应用"
                    status: "completed"
                    progress: 1.0
                    created_at: "2024-09-07T10:30:00Z"
                    slide_count: 20
                    download_url: "https://api.ai-ppt-assistant.com/v1/presentations/550e8400-e29b-41d4-a716-446655440000/download"
                total: 50
                limit: 20
                offset: 0
                has_more: true
                next_offset: 20
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /presentations/{id}:
    get:
      tags:
        - Presentations
      summary: 获取演示文稿状态
      description: 获取指定演示文稿的详细状态信息
      operationId: getPresentationStatus
      parameters:
        - $ref: '#/components/parameters/PresentationId'
      responses:
        '200':
          description: 演示文稿详细信息
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PresentationResponse'
              example:
                presentation_id: "550e8400-e29b-41d4-a716-446655440000"
                title: "人工智能在医疗领域的应用"
                status: "completed"
                progress: 1.0
                created_at: "2024-09-07T10:30:00Z"
                updated_at: "2024-09-07T10:45:00Z"
                slide_count: 20
                download_url: "https://api.ai-ppt-assistant.com/v1/presentations/550e8400-e29b-41d4-a716-446655440000/download"
                preview_url: "https://api.ai-ppt-assistant.com/v1/presentations/550e8400-e29b-41d4-a716-446655440000/preview"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /presentations/{id}/download:
    get:
      tags:
        - Presentations
      summary: 下载演示文稿
      description: 下载完成的演示文稿文件（PPTX格式）
      operationId: downloadPresentation
      parameters:
        - $ref: '#/components/parameters/PresentationId'
      responses:
        '200':
          description: 演示文稿文件
          content:
            application/vnd.openxmlformats-officedocument.presentationml.presentation:
              schema:
                type: string
                format: binary
          headers:
            Content-Disposition:
              description: 文件下载标头
              schema:
                type: string
                example: 'attachment; filename="presentation.pptx"'
            Content-Length:
              description: 文件大小
              schema:
                type: integer
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          description: 演示文稿尚未完成
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error: "PRESENTATION_NOT_READY"
                message: "演示文稿尚未生成完成，请稍后再试"
                request_id: "req-123456789"
                timestamp: "2024-09-07T10:30:00Z"
        '500':
          $ref: '#/components/responses/InternalServerError'

  /presentations/{id}/slides/{slideId}:
    patch:
      tags:
        - Presentations
      summary: 修改幻灯片
      description: |
        修改指定幻灯片的内容、样式或布局。支持多种修改类型：
        - content: 修改文本内容
        - style: 修改样式设置
        - layout: 修改布局结构
        - image: 添加、替换或调整图片
        - speaker_notes: 修改演讲备注
      operationId: modifySlide
      parameters:
        - $ref: '#/components/parameters/PresentationId'
        - $ref: '#/components/parameters/SlideId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ModifySlideRequest'
            example:
              modification_type: "content"
              content:
                title: "AI诊断系统的核心优势"
                body: "基于深度学习的AI诊断系统具有高准确性、快速响应和持续学习能力"
                bullet_points:
                  - "99.5% 的诊断准确率"
                  - "3秒内完成初步诊断"
                  - "支持24/7不间断服务"
              instructions: "请突出强调准确率数据，添加相关的图表说明"
      responses:
        '200':
          description: 幻灯片修改成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: 操作结果消息
                  slide_id:
                    type: string
                    description: 修改的幻灯片ID
                  modified_at:
                    type: string
                    format: date-time
                    description: 修改时间
              example:
                message: "幻灯片修改成功"
                slide_id: "slide-001"
                modified_at: "2024-09-07T10:50:00Z"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          description: 演示文稿状态不允许修改
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error: "PRESENTATION_NOT_MODIFIABLE"
                message: "演示文稿当前状态不允许修改"
                request_id: "req-123456789"
                timestamp: "2024-09-07T10:30:00Z"
        '500':
          $ref: '#/components/responses/InternalServerError'

  /sessions:
    post:
      tags:
        - Sessions
      summary: 创建会话
      description: 创建新的用户会话，用于跟踪用户的交互历史
      operationId: createSession
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSessionRequest'
            example:
              user_id: "user123"
              session_name: "医疗AI演示准备"
              metadata:
                project: "healthcare-ai"
                deadline: "2024-12-31"
      responses:
        '202':
          description: 会话创建成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionResponse'
              example:
                session_id: "550e8400-e29b-41d4-a716-446655440000"
                user_id: "user123"
                session_name: "医疗AI演示准备"
                status: "active"
                created_at: "2024-09-07T10:00:00Z"
                expires_at: "2024-09-07T18:00:00Z"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /sessions/{id}:
    get:
      tags:
        - Sessions
      summary: 获取会话信息
      description: 获取指定会话的详细信息
      operationId: getSession
      parameters:
        - $ref: '#/components/parameters/SessionId'
      responses:
        '200':
          description: 会话详细信息
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionResponse'
              example:
                session_id: "550e8400-e29b-41d4-a716-446655440000"
                user_id: "user123"
                session_name: "医疗AI演示准备"
                status: "active"
                created_at: "2024-09-07T10:00:00Z"
                last_activity: "2024-09-07T10:30:00Z"
                expires_at: "2024-09-07T18:00:00Z"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /agents/{name}/execute:
    post:
      tags:
        - Agents
      summary: 执行AI代理
      description: |
        执行指定的AI代理来处理用户请求。支持的代理类型：
        - orchestrator: 主协调代理
        - content: 内容生成代理
        - visual: 视觉设计代理
        - compiler: 演示文稿编译代理
      operationId: executeAgent
      parameters:
        - $ref: '#/components/parameters/AgentName'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExecuteAgentRequest'
            example:
              input: "生成一个关于机器学习基础的10页演示文稿"
              session_id: "550e8400-e29b-41d4-a716-446655440000"
              enable_trace: false
              parameters:
                temperature: 0.7
                max_tokens: 1000
      responses:
        '202':
          description: 代理执行已开始
          content:
            application/json:
              schema:
                type: object
                properties:
                  task_id:
                    type: string
                    format: uuid
                    description: 任务ID
                  agent_name:
                    type: string
                    description: 执行的代理名称
                  status:
                    type: string
                    description: 执行状态
                  started_at:
                    type: string
                    format: date-time
                    description: 开始时间
              example:
                task_id: "550e8400-e29b-41d4-a716-446655440000"
                agent_name: "orchestrator"
                status: "processing"
                started_at: "2024-09-07T10:30:00Z"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: 指定的代理不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error: "AGENT_NOT_FOUND"
                message: "指定的代理不存在"
                request_id: "req-123456789"
                timestamp: "2024-09-07T10:30:00Z"
        '500':
          $ref: '#/components/responses/InternalServerError'

  /tasks/{task_id}:
    get:
      tags:
        - Tasks
      summary: 获取任务状态
      description: 获取指定任务的执行状态和结果
      operationId: getTaskStatus
      parameters:
        - $ref: '#/components/parameters/TaskId'
      responses:
        '200':
          description: 任务状态信息
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaskResponse'
              example:
                task_id: "550e8400-e29b-41d4-a716-446655440000"
                type: "generate_presentation"
                status: "completed"
                progress: 1.0
                result:
                  presentation_id: "550e8400-e29b-41d4-a716-446655440000"
                  download_url: "https://api.ai-ppt-assistant.com/v1/presentations/550e8400-e29b-41d4-a716-446655440000/download"
                created_at: "2024-09-07T10:30:00Z"
                updated_at: "2024-09-07T10:45:00Z"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /templates:
    get:
      tags:
        - Templates
      summary: 获取模板列表
      description: 获取可用的演示文稿模板列表
      operationId: getTemplates
      parameters:
        - name: category
          in: query
          description: 模板分类过滤
          schema:
            type: string
            enum: [商务, 技术, 销售, 教育]
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: 模板列表
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Template'
              example:
                - template_id: "executive_summary"
                  name: "执行摘要"
                  description: "适用于高管汇报的专业模板"
                  category: "商务"
                  style: "corporate"
                  default_slide_count: 15
                  preview_url: "https://api.ai-ppt-assistant.com/v1/templates/executive_summary/preview"
                - template_id: "technology_showcase"
                  name: "技术展示"
                  description: "展示技术产品和创新的模板"
                  category: "技术"
                  style: "modern"
                  default_slide_count: 20
                  preview_url: "https://api.ai-ppt-assistant.com/v1/templates/technology_showcase/preview"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /health:
    get:
      tags:
        - Health
      summary: 健康检查
      description: 检查API服务的健康状态
      operationId: healthCheck
      security: []  # 健康检查不需要API密钥
      responses:
        '200':
          description: 服务健康
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
              example:
                status: "healthy"
                timestamp: "2024-09-07T10:30:00Z"
                version: "1.0.0"
                dependencies:
                  database: "healthy"
                  s3: "healthy"
                  lambda: "healthy"
        '503':
          description: 服务不健康
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
              example:
                status: "unhealthy"
                timestamp: "2024-09-07T10:30:00Z"
                version: "1.0.0"
                dependencies:
                  database: "unhealthy"
                  s3: "healthy"
                  lambda: "healthy"

  /health/ready:
    get:
      tags:
        - Health
      summary: 就绪检查
      description: 检查API服务是否准备好接受请求
      operationId: readinessCheck
      security: []  # 就绪检查不需要API密钥
      responses:
        '200':
          description: 服务已就绪
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "ready"
                  timestamp:
                    type: string
                    format: date-time
                    example: "2024-09-07T10:30:00Z"
        '503':
          description: 服务未就绪
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "not ready"
                  timestamp:
                    type: string
                    format: date-time
                    example: "2024-09-07T10:30:00Z"

tags:
  - name: Presentations
    description: 演示文稿生成和管理
  - name: Sessions
    description: 用户会话管理
  - name: Agents
    description: AI代理执行
  - name: Tasks
    description: 任务状态跟踪
  - name: Templates
    description: 演示文稿模板
  - name: Health
    description: 系统健康检查

externalDocs:
  description: 详细文档和使用指南
  url: https://docs.ai-ppt-assistant.com