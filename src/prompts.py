"""
提示词模板 - 专业咨询顾问风格的PPT内容生成提示词
基于麦肯锡、BCG等顶级咨询公司的演示方法论
"""

OUTLINE_PROMPT = """你是一位资深的战略咨询顾问，精通麦肯锡、BCG等顶级咨询公司的演示方法论。请运用金字塔原理和MECE框架，为以下商业议题构建一个{page_count}页的执行演示文稿结构：

商业议题：{topic}

结构化要求：
1. 第1页：标题页与执行摘要（Title & Executive Summary）- 核心洞察和价值主张
2. 第2页：议题背景与挑战（Situation & Complication）- 明确问题定义
3. 中间页面：遵循MECE原则的逻辑论证
   - 采用"情境-复杂性-问题-解决方案"(SCQA)框架
   - 每个论点必须可量化或有案例支撑
   - 确保论点之间互斥且完全穷尽
4. 倒数第2页：关键洞察与建议（Key Insights & Recommendations）
5. 最后一页：行动计划与后续步骤（Action Plan & Next Steps）

请以JSON格式返回大纲，格式如下：
{{
  "title": "{topic}",
  "executive_summary": "一句话核心价值主张",
  "slides": [
    {{
      "slide_number": 1,
      "slide_type": "title/analysis/data/recommendation/action",
      "title": "页面标题（采用动作导向的陈述句）",
      "key_message": "核心观点（一句话总结该页价值）",
      "content": ["关键洞察1", "关键洞察2", "关键洞察3"],
      "supporting_structure": "bullet/matrix/chart/framework",
      "logic_flow": "与前后页的逻辑关系说明"
    }}
  ],
  "metadata": {{
    "total_slides": {page_count},
    "estimated_duration": "15-20分钟",
    "methodology": "MECE + 金字塔原理",
    "created_at": "时间戳"
  }}
}}

请确保JSON格式正确，可以直接解析。"""

CONTENT_PROMPT = """作为战略咨询顾问，请为以下演示页面构建具有洞察力的内容结构：

页面定位：
- 标题：{page_title}
- 战略目标：{page_purpose}
- 整体议题：{topic}
- 页码：第{slide_number}页

内容生成框架：

1. 【核心论点】生成一个有力度的标题陈述句
   - 采用"So What"测试（读者看完应得到什么关键信息）
   - 包含具体洞察或明确观点
   - 字数：10-30字

2. 【支撑论据】构建3个MECE结构的关键洞察
   - 每个论据必须：
     * 以数据、事实或分析为基础
     * 采用对比、趋势或因果逻辑
     * 提供可行动的洞察
   - 格式：洞察陈述 + 支撑要点（每点30-200字符）
   - 确保三点之间逻辑递进或并列完整

3. 【关键启示】一句话价值总结
   - 回答"这意味着什么"和"为什么重要"

4. 【演讲者备注】结构化讲述要点
   - 开场：链接上页内容（15秒）
   - 展开：三个论据的深度解释
   - 过渡：引导至下一页逻辑（15秒）

请以JSON格式返回：
{{
  "slide_number": {slide_number},
  "title": "{page_title}",
  "headline": "页面核心论点",
  "bullet_points": [
    "洞察1：具体的发现或建议",
    "洞察2：支撑性的数据或趋势",
    "洞察3：行动导向的结论"
  ],
  "key_takeaway": "关键启示：这意味着什么",
  "speaker_notes": "开场衔接：基于前面的分析...\\n\\n核心论述：本页的关键信息是...首先...其次...最后...\\n\\n过渡引导：这为我们下一步讨论...奠定了基础。"
}}

请确保JSON格式正确，可以直接解析。"""

# 新增：演讲者备注专用提示词
SPEAKER_NOTES_PROMPT = """作为资深咨询合伙人，为以下演示页面准备专业的演讲脚本：

页面信息：
- 标题：{title}
- 核心内容：{content}
- 当前页码：第{current_slide}页，共{total_slides}页

演讲脚本结构（2-3分钟）：

1. 【开场衔接】（15-20秒）
   - 简要回顾上页关键结论
   - 设置本页议题的重要性

2. 【核心论述】（90-120秒）
   采用"层层深入"的叙事方法：
   - 第一层：陈述核心观点及其商业意义
   - 第二层：用数据和案例展开论证
   - 第三层：处理潜在异议

3. 【互动要素】（20-30秒）
   - 设置战略性问题引发思考
   - 预判可能的提问

4. 【收尾过渡】（10-15秒）
   - 总结本页关键要点
   - 自然引入下一个议题

请以结构化的演讲要点形式返回，语言专业但不失亲和力。"""

# 图片生成提示词优化
IMAGE_GENERATION_CONSULTANT_STYLE = """
生成符合顶级咨询公司演示标准的专业商务图片：
- 风格：简洁、现代、专业
- 色调：商务蓝、深灰、白色为主
- 元素：抽象几何、数据可视化、商业图标
- 避免：过度装饰、卡通风格、杂乱背景
主题关键词：{keywords}
"""